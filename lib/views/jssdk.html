{% extends 'index.html' %} {% block body %}
<div>
    <div class="container">
        <h1>JSSDK测试页</h1>

        <h2><a class="btn btn-success QRScan">测试扫码</a></h2>

        <div class="lbox_close wxapi_form">
            <h3 id="menu-basic">基础接口</h3>
            <span class="desc">判断当前客户端是否支持指定JS接口</span>
            <button class="btn btn_primary" id="checkJsApi">checkJsApi</button>

            <h3 id="menu-share">分享接口</h3>
            <span class="desc">获取“分享到朋友圈”按钮点击状态及自定义分享内容接口</span>
            <button class="btn btn_primary" id="onMenuShareTimeline">onMenuShareTimeline</button>
            <span class="desc">获取“分享给朋友”按钮点击状态及自定义分享内容接口</span>
            <button class="btn btn_primary" id="onMenuShareAppMessage">onMenuShareAppMessage</button>
            <span class="desc">获取“分享到QQ”按钮点击状态及自定义分享内容接口</span>
            <button class="btn btn_primary" id="onMenuShareQQ">onMenuShareQQ</button>
            <span class="desc">获取“分享到腾讯微博”按钮点击状态及自定义分享内容接口</span>
            <button class="btn btn_primary" id="onMenuShareWeibo">onMenuShareWeibo</button>
            <span class="desc">获取“分享到QZone”按钮点击状态及自定义分享内容接口</span>
            <button class="btn btn_primary" id="onMenuShareQZone">onMenuShareQZone</button>

            <h3 id="menu-image">图像接口</h3>
            <span class="desc">拍照或从手机相册中选图接口</span>
            <button class="btn btn_primary" id="chooseImage">chooseImage</button>
            <span class="desc">预览图片接口</span>
            <button class="btn btn_primary" id="previewImage">previewImage</button>
            <span class="desc">上传图片接口</span>
            <button class="btn btn_primary" id="uploadImage">uploadImage</button>
            <span class="desc">下载图片接口</span>
            <button class="btn btn_primary" id="downloadImage">downloadImage</button>

            <h3 id="menu-voice">音频接口</h3>
            <span class="desc">开始录音接口</span>
            <button class="btn btn_primary" id="startRecord">startRecord</button>
            <span class="desc">停止录音接口</span>
            <button class="btn btn_primary" id="stopRecord">stopRecord</button>
            <span class="desc">播放语音接口</span>
            <button class="btn btn_primary" id="playVoice">playVoice</button>
            <span class="desc">暂停播放接口</span>
            <button class="btn btn_primary" id="pauseVoice">pauseVoice</button>
            <span class="desc">停止播放接口</span>
            <button class="btn btn_primary" id="stopVoice">stopVoice</button>
            <span class="desc">上传语音接口</span>
            <button class="btn btn_primary" id="uploadVoice">uploadVoice</button>
            <span class="desc">下载语音接口</span>
            <button class="btn btn_primary" id="downloadVoice">downloadVoice</button>

            <h3 id="menu-smart">智能接口</h3>
            <span class="desc">识别音频并返回识别结果接口</span>
            <button class="btn btn_primary" id="translateVoice">translateVoice</button>

            <h3 id="menu-device">设备信息接口</h3>
            <span class="desc">获取网络状态接口</span>
            <button class="btn btn_primary" id="getNetworkType">getNetworkType</button>

            <h3 id="menu-location">地理位置接口</h3>
            <span class="desc">使用微信内置地图查看位置接口</span>
            <button class="btn btn_primary" id="openLocation">openLocation</button>
            <span class="desc">获取地理位置接口</span>
            <button class="btn btn_primary" id="getLocation">getLocation</button>

            <h3 id="menu-webview">界面操作接口</h3>
            <span class="desc">隐藏右上角菜单接口</span>
            <button class="btn btn_primary" id="hideOptionMenu">hideOptionMenu</button>
            <span class="desc">显示右上角菜单接口</span>
            <button class="btn btn_primary" id="showOptionMenu">showOptionMenu</button>
            <span class="desc">关闭当前网页窗口接口</span>
            <button class="btn btn_primary" id="closeWindow">closeWindow</button>
            <span class="desc">批量隐藏功能按钮接口</span>
            <button class="btn btn_primary" id="hideMenuItems">hideMenuItems</button>
            <span class="desc">批量显示功能按钮接口</span>
            <button class="btn btn_primary" id="showMenuItems">showMenuItems</button>
            <span class="desc">隐藏所有非基础按钮接口</span>
            <button class="btn btn_primary" id="hideAllNonBaseMenuItem">hideAllNonBaseMenuItem</button>
            <span class="desc">显示所有功能按钮接口</span>
            <button class="btn btn_primary" id="showAllNonBaseMenuItem">showAllNonBaseMenuItem</button>

            <h3 id="menu-scan">微信扫一扫</h3>
            <span class="desc">调起微信扫一扫接口</span>
            <button class="btn btn_primary" id="scanQRCode0">scanQRCode(微信处理结果)</button>
            <button class="btn btn_primary" id="scanQRCode1">scanQRCode(直接返回结果)</button>

            <h3 id="menu-shopping">微信小店接口</h3>
            <span class="desc">跳转微信商品页接口</span>
            <button class="btn btn_primary" id="openProductSpecificView">openProductSpecificView</button>

            <h3 id="menu-card">微信卡券接口</h3>
            <span class="desc">批量添加卡券接口</span>
            <button class="btn btn_primary" id="addCard">addCard</button>
            <span class="desc">调起适用于门店的卡券列表并获取用户选择列表</span>
            <button class="btn btn_primary" id="chooseCard">chooseCard</button>
            <span class="desc">查看微信卡包中的卡券接口</span>
            <button class="btn btn_primary" id="openCard">openCard</button>

            <h3 id="menu-pay">微信支付接口</h3>
            <span class="desc">发起一个微信支付请求</span>
            <button class="btn btn_primary" id="chooseWXPay">chooseWXPay</button>
        </div>
    </div>
</div>
{% endblock %} {% block scripts %}
<!-- -->
{{ super() }}
<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<script>
    $(document).ready(function() {
        var url = "/api/jssdk/config"; // weixin/
        var weixinUrl = location.href.split('#')[0];
        console.log(weixinUrl);
        console.log(JSON.stringify(location));
        $.ajax({
            url: url, //这个地址是服务器配置JSSDK的地址
            data: {
                url: weixinUrl
                    //这个地址是发生jssdk调用的url地址
            }
        }).success(function(json) {
            console.log(JSON.stringify(json.data));
            var data = json.data;
            var config = {};
            for (var k in json.data) {
                config[k] = json.data[k];
            }
            config.debug = true;
            config.jsApiList = [
                // 'checkJsApi',
                // 'scanQRCode'
                'checkJsApi',
                'onMenuShareTimeline',
                'onMenuShareAppMessage',
                'onMenuShareQQ',
                'onMenuShareWeibo',
                'onMenuShareQZone',
                'hideMenuItems',
                'showMenuItems',
                'hideAllNonBaseMenuItem',
                'showAllNonBaseMenuItem',
                'translateVoice',
                'startRecord',
                'stopRecord',
                'onVoiceRecordEnd',
                'playVoice',
                'onVoicePlayEnd',
                'pauseVoice',
                'stopVoice',
                'uploadVoice',
                'downloadVoice',
                'chooseImage',
                'previewImage',
                'uploadImage',
                'downloadImage',
                'getNetworkType',
                'openLocation',
                'getLocation',
                'hideOptionMenu',
                'showOptionMenu',
                'closeWindow',
                'scanQRCode',
                'chooseWXPay',
                'openProductSpecificView',
                'addCard',
                'chooseCard',
                'openCard'
            ];
            config.timestamp = parseInt(config.timestamp);
            wx.config(config);
            // wx.ready(function() {
            //     alert("微信jssdk配置成功!");
            //     $('h2 > a.QRScan').click(function() {
            //         wx.scanQRCode({
            //             needResult: 1, // 默认为0，扫描结果由微信处理，1则直接返回扫描结果，
            //             scanType: ["qrCode", "barCode"], // 可以指定扫二维码还是一维码，默认二者都有
            //             success: function(res) {
            //                 var result = res.resultStr; // 当needResult 为 1 时，扫码返回的结果
            //                 alert(result);
            //             }
            //         });
            //     });
            // });
            // wx.error(function(res) {
            //     console.log('微信JSSDK配置失败！');
            //     console.log(JSON.stringify(res));
            //     console.log(res.errMsg);
            // });
        });
    });
</script>
<link rel="stylesheet" href="/css/jssdk_demo.css">
<script src="/js/jssdk_demo.js">
</script>
{% endblock %}